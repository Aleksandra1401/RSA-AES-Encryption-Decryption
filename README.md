# RSA AES Encryption/Decryption Using Java.security and Java.crypto Libraries
Final project for professional ethics class

Over the course of semester, we covered different aspects of cyber security laws and methods to protect our privacy online. Impressed by simple, yet brilliant use of prime numbers in computer science as well as their application in encryption algorithms I had a desire to learn more about this topic. My original idea was to develop my own version of RSA encryption. Discovering Java.security and Java.crypto libraries, I thought how it would be much more useful to learn to encrypt and decrypt data using already established methods for developers and get a feeling how encryption is implemented in real-life applications. As I found out during my research, this was a good decision because making my own encryption would break the golden rule in crypto community stating that we should never make our own encryption but use already vetted methods instead (Sheth, 2017). The reason behind this rule is the complexity of encryption algorithms that makes a regular developer incompetent for this task. Encryption algorithms for developers’ use are carefully researched and tested by the people who devoted their careers to this field. Making our own encryption would most likely create vulnerabilities that would be easily exploited by cryptographers and hackers.  
Another important rule developers should stick to is following advice of security researchers. Security researchers work on providing security methods that developers use for security of their applications. All the work of security researchers is useless if developers aren’t implementing these safety methods. Developer should be informed about all important updates because safety measures get updated and implementing outdated security measures may be just a waste of developer’s time. According to Mansi Sheth, security researcher at Vera Code, misuses of cryptography are frequent due to the lack of proper documentation, guidelines, and literature on this topic (2017). She pointed out that even the documentation of Java Security Architecture (JCA) uses examples on broken algorithms such as DES, RC2 or RC5 making the choice overwhelming, and instructions unclear for those who aren’t as familiar with this architecture (Sheth, 2017). Availability of broken encryption algorithms is not beneficial and teaching on those most likely cause more confusion and misuse than benefit. In her blog post from 2017, Sheth suggests Rivest-Shamir-Edleman(RSA) for asymmetric and Advanced Encryption Standard(AES) for symmetric encryption. According to the follow up from 2021, these algorithms are still a standard, and the only thing that is different due to increased cpu power is the size of keys in use. 
In my proposal, I stated that I would implement a program to decrypt data using RSA algorithm. Because of the complexity of prime number generation that makes this algorithm strong, RSA is unfortunately not a best choice for encrypting the large amount of data. Common practice when it comes to file encryption is encrypting the data using AES and then securing the AES key with RSA encryption. Therefore, the resulting application implements both AES and RSA practices to demonstrate how combination of these safety protocols works. Cryptography is a field much more complex than just this; it incorporates many more protocols and security measures, that are beyond the scope of my current skillset, and therefore, my project focuses solely on the demonstration of usage of encryption using these two algorithms. In my project, I followed the instructions of Sheth, making my RSA and AES keys of sizes 4092 and 256 bits respectfully. RSA algorithm uses 2 keys meaning that the size of each key is 2048 bits. Generation of random number is obtained by using SecureRandom class that enables the high randomness of generated number. As a computer science student, I am aware that the randomness for a machine is yet an unreached ideal, and that the Random Java class that is commonly used is not good enough for this task. For fact, this class should be avoided if randomness is of high importance in our project.
RSA algorithm is an algorithm that uses modular arithmetic of prime numbers, meaning that provided a key pair, where one key encrypts data, decryption is possible only provided the other key from the pair. In the YouTube video shared by Computerphile Dr Tim Muller explains this process. In simple words, generating two large prime numbers p and q, and calculate their product, as well as the product of p-1 and q-1. Then we find the number e that is greater than 1 and less than product of p-1 and q-1. This number can be arbitrarily chosen if it satisfies the previous condition, and it is our first magic number. The second magic number is obtained by using modulo operation of the number one less than our magic number on the product of p-1 and q-1. This way only those who know numbers p and q can deduce the secret magic numbers that make everything cancel out. Based on product of two large prime numbers that have 600 digits even for computers it is nearly impossible to find out what p and q are.
On the other hand, AES also known as Rijndael is a symmetric encryption algorithm, meaning that the key that encrypted data is also used to decrypt it. This is a symmetric block cipher, meaning that encrypts blocks of data, joining them together in cyphertext. Dr. Mike Pound explains how the encryption works. Since encryption is done on blocks of data where each block is 16 bytes, a 4x4 matrix holds this data. Operations that are performed on each block are XOR using the AES key, byte substitution, row shifting and column mixing and XORing the result with the key again. This is done on each block in rounds where the size of the key specifies the number of rounds performed. The key is expanded for each round, meaning that each round uses a different key. Given the complexity of scrambling on each block, decryption is also possible only if one has the AES key. Dr. Pound agrees with Sheth when it comes to the vulnerabilities caused by mistakes in implementation, pointing out that it doesn’t take much to ruin the work we’ve done.
My application is simple application that once executed, shows GUI prompting user for the absolute path of the file to encrypt or decrypt. It also gives the option of choosing the file by locating it on the machine. Once the path is provided, user can choose between encryption or decryption. For demonstrational purposes, file encryption creates the copy of the file that is encrypted, appending “Encrypted” on the name of the file. Behind the scenes after “Encryption” is chosen, RSA key pair gets generated and stored in files with “.pub” and “.txt” extensions for public and private key storage, respectfully. Private key is used for encryption of AES key, and AES key will encrypt and decrypt our data. Public key is used in case of file decryption to decrypt the AES key. Once encryption process starts, encrypted AES key is the first piece of data that is written to our destination file, followed by initialization vector (a variable that is used in the first seed of AES key) and encrypted data from the file we are encrypting. Decryption process loads the public key from “.txt” file, opens encrypted file for reading and recovers the AES key to decrypt data. Once AES key is obtained, we can decrypt data and write it to the new file with appended “Decrypted” in the name, also used for the demonstrational purposes of this project. All guidelines used in project design are listed in references.















References

Computerphile. (2019, November 22). Aes Explained (Advanced Encryption Standard) – Computerphile[Video]. YouTube. Retrieved December 12, 2021, from AES Explained (Advanced Encryption Standard) - Computerphile - YouTube
Computerphile. (2021, January 8). Prime Numbers & RSA Encryption Algorithm – Computerphile [Video]. YouTube. Retrieved December 12, 2021, from Prime Numbers & RSA Encryption Algorithm - Computerphile - YouTube
Java Cryptography Architecture (JCA) Reference Guide. Oracle. Java Cryptography Architecture (JCA) Reference Guide (oracle.com)
Java Security Overview. Oracle. Java Security Overview (oracle.com)
Sheth, M. (2017, March 19). Cryptographically Secure Pseudo-Random Number Generator (CSPRNG). Vera Code. Cryptographically Secure Pseudo-Random Number Generator (CSPRNG) | Veracode
Sheth, M. (2017, April 18). Encryption and Decryption in Java Cryptography. Vera Code. Encryption and Decryption in Java Cryptography | Veracode
Sheth, M. (2020, November 16). Java Crypto Catchup. Vera Code. Java Crypto Catchup | Veracode Blog
Sridhar, J. (2017, November 3). Using AES With RSA for File Encryption and Decryption in Java. Novixys. Using AES With RSA for File Encryption and Decryption in Java | Novixys Software Dev Blog

 
